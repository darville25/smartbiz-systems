<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartBiz AI Commander | The Marketing OS for Kenya</title>
    <meta name="description" content="The ultimate AI tool for Kenyan Business, Influencers, and Job Seekers.">
    
    <!-- Paystack SDK -->
    <script src="https://js.paystack.co/v1/inline.js"></script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Custom Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        brand: {
                            dark: '#0B0F19',       
                            card: '#161E2E',       
                            neon: '#2DD4BF',       
                            neonhover: '#14B8A6',
                            purple: '#A78BFA',
                            orange: '#FB923C', 
                            pink: '#F472B6',   
                            text: '#FFFFFF',       
                        }
                    },
                    boxShadow: {
                        'neon': '0 0 20px rgba(45, 212, 191, 0.4)',
                        'app': '0 25px 50px -12px rgba(0, 0, 0, 0.9)',
                        'card-hover': '0 20px 40px -5px rgba(0, 0, 0, 0.6)'
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                    }
                }
            }
        }
    </script>

    <style>
        body { background-color: #0B0F19; color: #FFFFFF; }
        .glass-panel { background: rgba(11, 15, 25, 0.98); border-bottom: 1px solid rgba(255, 255, 255, 0.1); }
        .text-gradient { background: linear-gradient(to right, #2DD4BF, #A78BFA); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .app-scroll::-webkit-scrollbar { width: 6px; }
        .app-scroll::-webkit-scrollbar-track { background: #111827; }
        .app-scroll::-webkit-scrollbar-thumb { background: #374151; border-radius: 3px; }
        .app-scroll::-webkit-scrollbar-thumb:hover { background: #4B5563; }
        input[type=range] { -webkit-appearance: none; background: transparent; }
        input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; height: 16px; width: 16px; border-radius: 50%; background: #2DD4BF; cursor: pointer; margin-top: -6px; }
        input[type=range]::-webkit-slider-runnable-track { width: 100%; height: 4px; cursor: pointer; background: #4B5563; border-radius: 2px; }
        .hidden-view { display: none !important; }
        #global-loader { transition: opacity 0.5s ease; pointer-events: none; }
    </style>
</head>
<body class="antialiased selection:bg-brand-neon selection:text-brand-dark overflow-x-hidden">

    <!-- LOADING OVERLAY -->
    <div id="global-loader" class="fixed inset-0 z-[100] flex flex-col items-center justify-center bg-[#0B0F19]">
        <div class="w-16 h-16 border-4 border-gray-800 border-t-brand-neon rounded-full animate-spin mb-4"></div>
        <p class="text-brand-neon font-mono text-sm animate-pulse">Initializing SmartBiz...</p>
    </div>

    <!-- NAVIGATION -->
    <nav class="fixed w-full z-50 glass-panel">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-20">
                <a href="index.html" class="flex-shrink-0 flex items-center cursor-pointer group">
                    <span class="text-2xl font-bold tracking-tight text-white group-hover:text-brand-neon transition">
                        SmartBiz<span class="text-brand-neon group-hover:text-white transition">Tool</span>
                    </span>
                    <span class="ml-2 text-xs bg-brand-purple/20 text-brand-purple border border-brand-purple/50 px-2 py-0.5 rounded font-bold uppercase tracking-wide">Beta</span>
                </a>
                <div class="hidden md:flex space-x-6 items-center">
                    <a href="#features" class="text-sm font-bold text-gray-200 hover:text-white transition-colors">Features</a>
                    <a href="#pricing" class="text-sm font-bold text-gray-200 hover:text-white transition-colors">Pricing</a>
                    <a href="index.html" class="text-sm font-bold text-gray-200 hover:text-brand-neon transition-colors">Back to Agency</a>
                    <div class="h-6 w-px bg-gray-700 mx-2"></div>
                    <button type="button" onclick="Clerk.openSignIn()" class="px-5 py-2.5 text-sm font-bold text-white border border-gray-600 rounded-lg hover:bg-gray-800 transition-all">Login</button>
                    <button type="button" onclick="Clerk.openSignUp()" class="px-5 py-2.5 text-sm font-bold text-brand-dark bg-brand-neon rounded-lg hover:bg-brand-neonhover hover:shadow-neon transition-all">Start for Free</button>
                </div>
                <div class="md:hidden">
                    <button type="button" onclick="toggleMobileMenu()" class="text-white p-2 border border-gray-800 rounded-lg">
                        <i id="menu-icon" class="fa-solid fa-bars text-2xl"></i>
                    </button>
                </div>
            </div>
        </div>
        <!-- MOBILE MENU -->
        <div id="mobile-menu" class="hidden md:hidden bg-[#0B0F19] border-t border-gray-800 absolute w-full left-0 shadow-2xl h-screen overflow-y-auto pb-20">
            <div class="px-4 pt-4 space-y-1">
                <p class="px-3 pt-4 pb-2 text-xs font-bold text-gray-500 uppercase tracking-wider">Navigation</p>
                <a href="#features" onclick="toggleMobileMenu()" class="block px-3 py-3 rounded-lg text-base font-medium text-gray-300 hover:bg-gray-800 hover:text-white transition">Features</a>
                <a href="#pricing" onclick="toggleMobileMenu()" class="block px-3 py-3 rounded-lg text-base font-medium text-gray-300 hover:bg-gray-800 hover:text-white transition">Pricing</a>
                <a href="index.html" onclick="toggleMobileMenu()" class="block px-3 py-3 rounded-lg text-base font-medium text-gray-300 hover:bg-gray-800 hover:text-white transition">Back to Main Site</a>
                <div class="h-px bg-gray-800 my-4"></div>
                <button type="button" onclick="Clerk.openSignIn()" class="block w-full text-center px-3 py-3 rounded-lg text-base font-bold text-white bg-gray-800 border border-gray-700 mb-3">Login</button>
                <button type="button" onclick="Clerk.openSignUp()" class="block w-full text-center px-5 py-3 text-base font-bold text-brand-dark bg-brand-neon rounded-lg hover:bg-brand-neonhover transition">Start for Free</button>
                <div class="pb-24"></div>
            </div>
        </div>
    </nav>

    <!-- HERO SECTION -->
    <section class="relative pt-32 pb-20 lg:pt-40 overflow-hidden">
        <div class="absolute inset-0 bg-[linear-gradient(to_right,#80808012_1px,transparent_1px),linear-gradient(to_bottom,#80808012_1px,transparent_1px)] bg-[size:24px_24px]"></div>
        <div class="relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <div class="inline-flex items-center px-4 py-2 rounded-full border border-gray-600 bg-gray-900 mb-8 animate-float shadow-lg">
                <span class="w-2 h-2 rounded-full bg-brand-neon mr-2 animate-pulse"></span>
                <span class="text-sm font-bold text-gray-100">Now Solving: Debt Collection & WhatsApp Agents</span>
            </div>
            <h1 class="text-4xl lg:text-6xl font-extrabold tracking-tight mb-6 text-white leading-tight">
                Solve Real Kenyan Business<br><span class="text-gradient">Problems in Seconds.</span>
            </h1>
            <p class="text-lg text-gray-200 mb-10 max-w-3xl mx-auto leading-relaxed font-medium">
                Not just Ads. Configure intelligent WhatsApp Agents, generate Cold Call Scripts, and manage Debt Collection tailored for the Nairobi market.
            </p>

            <!-- APP INTERFACE -->
            <div class="relative max-w-7xl mx-auto text-left">
                <div class="absolute -inset-1 bg-gradient-to-r from-brand-neon to-brand-purple rounded-xl blur opacity-30"></div>
                <div class="relative bg-brand-dark border border-gray-600 rounded-xl shadow-app overflow-hidden flex flex-col md:flex-row min-h-[750px]">
                    
                    <!-- SIDEBAR -->
                    <div class="w-full md:w-72 bg-gray-900 border-r border-gray-700 flex flex-col">
                        <div class="p-4 border-b border-gray-800">
                            <span class="text-xs font-bold text-gray-400 uppercase tracking-wider">Select A Tool</span>
                        </div>
                        <div class="flex-1 overflow-y-auto app-scroll p-3 space-y-6">
                            
                            <!-- AI Agents -->
                            <div>
                                <h3 class="text-xs font-bold text-green-400 mb-2 px-2 uppercase flex items-center"><i class="fa-solid fa-robot mr-2"></i> AI Agents (Beta)</h3>
                                <div class="space-y-1">
                                    <button onclick="switchMode(this, 'WhatsApp Agent')" class="sidebar-btn w-full flex items-center px-3 py-2 text-sm font-bold text-green-400 bg-green-400/10 rounded-lg border border-green-400/30 shadow-sm transition-all hover:bg-green-400/20"><i class="fa-brands fa-whatsapp w-5 text-center"></i> Configure Bot</button>
                                </div>
                            </div>

                            <!-- Marketing -->
                            <div>
                                <h3 class="text-xs font-bold text-brand-neon mb-2 px-2 uppercase">Marketing & Sales</h3>
                                <div class="space-y-1">
                                    <button onclick="switchMode(this, 'FB & IG Ads')" class="sidebar-btn w-full flex items-center px-3 py-2 text-sm font-bold text-brand-neon bg-gray-800 rounded-lg border border-brand-neon/40 shadow-sm transition-all"><i class="fa-brands fa-facebook w-5 text-center"></i> Ads Generator</button>
                                    <button onclick="switchMode(this, 'Cold Call Script')" class="sidebar-btn w-full flex items-center px-3 py-2 text-sm font-medium text-gray-300 hover:text-white hover:bg-gray-800 rounded-lg transition-all"><i class="fa-solid fa-phone-volume w-5 text-center"></i> Cold Call Script</button>
                                    <button onclick="switchMode(this, 'WhatsApp Script')" class="sidebar-btn w-full flex items-center px-3 py-2 text-sm font-medium text-gray-300 hover:text-white hover:bg-gray-800 rounded-lg transition-all"><i class="fa-brands fa-whatsapp w-5 text-center"></i> WhatsApp Scripts</button>
                                    <button onclick="switchMode(this, 'SEO Blog Post')" class="sidebar-btn w-full flex items-center px-3 py-2 text-sm font-medium text-gray-300 hover:text-white hover:bg-gray-800 rounded-lg transition-all"><i class="fa-solid fa-pen-nib w-5 text-center"></i> SEO Blogs</button>
                                </div>
                            </div>

                            <!-- Ops -->
                            <div>
                                <h3 class="text-xs font-bold text-brand-orange mb-2 px-2 uppercase">Business Ops</h3>
                                <div class="space-y-1">
                                    <button onclick="switchMode(this, 'M-Pesa Parser')" class="sidebar-btn w-full flex items-center px-3 py-2 text-sm font-medium text-gray-300 hover:text-white hover:bg-gray-800 rounded-lg transition-all"><i class="fa-solid fa-file-csv w-5 text-center text-brand-orange"></i> M-Pesa To Excel</button>
                                    <button onclick="switchMode(this, 'Debt Collection')" class="sidebar-btn w-full flex items-center px-3 py-2 text-sm font-medium text-gray-300 hover:text-white hover:bg-gray-800 rounded-lg transition-all"><i class="fa-solid fa-hand-holding-dollar w-5 text-center text-brand-orange"></i> Debt Collection</button>
                                    <button onclick="switchMode(this, 'Tender Proposal')" class="sidebar-btn w-full flex items-center px-3 py-2 text-sm font-medium text-gray-300 hover:text-white hover:bg-gray-800 rounded-lg transition-all"><i class="fa-solid fa-file-contract w-5 text-center text-brand-orange"></i> Tender/Proposal</button>
                                </div>
                            </div>
                            
                            <!-- Influencers -->
                            <div>
                                <h3 class="text-xs font-bold text-brand-pink mb-2 px-2 uppercase">Influencers</h3>
                                <div class="space-y-1">
                                    <button onclick="switchMode(this, 'Brand Pitch Email')" class="sidebar-btn w-full flex items-center px-3 py-2 text-sm font-medium text-gray-300 hover:text-white hover:bg-gray-800 rounded-lg transition-all"><i class="fa-solid fa-paper-plane w-5 text-center text-brand-pink"></i> Brand Pitch</button>
                                    <button onclick="switchMode(this, 'Viral Hooks')" class="sidebar-btn w-full flex items-center px-3 py-2 text-sm font-medium text-gray-300 hover:text-white hover:bg-gray-800 rounded-lg transition-all"><i class="fa-brands fa-tiktok w-5 text-center text-brand-pink"></i> Viral Hooks</button>
                                </div>
                            </div>

                            <!-- Careers -->
                            <div>
                                <h3 class="text-xs font-bold text-white mb-2 px-2 uppercase">Careers</h3>
                                <div class="space-y-1">
                                    <button onclick="switchMode(this, 'LinkedIn Cold DM')" class="sidebar-btn w-full flex items-center px-3 py-2 text-sm font-medium text-gray-300 hover:text-white hover:bg-gray-800 rounded-lg transition-all"><i class="fa-brands fa-linkedin w-5 text-center"></i> LinkedIn Cold DM</button>
                                    <button onclick="switchMode(this, 'CV Polisher')" class="sidebar-btn w-full flex items-center px-3 py-2 text-sm font-medium text-gray-300 hover:text-white hover:bg-gray-800 rounded-lg transition-all"><i class="fa-solid fa-list-check w-5 text-center"></i> CV Polisher</button>
                                </div>
                            </div>
                        </div>
                        
                        <div id="userProfileArea" class="p-4 border-t border-gray-700 bg-gray-800">
                            <div class="flex items-center opacity-50">
                                <div class="w-8 h-8 rounded-full bg-gray-600"></div>
                                <div class="ml-3"><p class="text-xs font-bold text-white">Loading...</p></div>
                            </div>
                        </div>
                    </div>

                    <!-- MAIN WORKSPACE -->
                    <div class="flex-1 flex flex-col bg-gray-900" id="mainAppArea">
                        <!-- Top Bar -->
                        <div class="h-16 border-b border-gray-700 flex items-center justify-between px-6 bg-gray-800">
                            <h2 class="text-base font-bold text-white flex items-center"><i class="fa-solid fa-wand-magic-sparkles text-brand-neon mr-3"></i> <span id="currentMode">FB & IG Ads</span></h2>
                            <div class="flex items-center space-x-4">
                                <div id="authActionArea">
                                    <button onclick="Clerk.openSignIn()" class="hidden md:flex items-center space-x-2 text-xs font-bold text-gray-300 hover:text-brand-purple transition group">
                                        <i class="fa-solid fa-lock group-hover:animate-pulse"></i>
                                        <span>Login to Save History</span>
                                    </button>
                                </div>
                                <div class="h-6 w-px bg-gray-600 hidden md:block"></div>
                                <button onclick="exportToTxt()" class="px-4 py-2 bg-white text-brand-dark text-xs font-bold rounded hover:bg-gray-200 transition shadow-lg flex items-center"><i class="fa-solid fa-download mr-1"></i> Export</button>
                            </div>
                        </div>

                        <!-- 1. STANDARD WORKSPACE -->
                        <div id="standardWorkspace" class="flex-1 p-6 grid lg:grid-cols-2 gap-6 overflow-hidden">
                            <!-- Input Column -->
                            <div class="space-y-6 app-scroll overflow-y-auto pr-2 pb-10">
                                <div>
                                    <label id="label1" class="block text-xs font-bold text-brand-neon uppercase mb-2 tracking-wide">Product / Topic / Name</label>
                                    <textarea id="productInput" placeholder="e.g. Leather Shoes / My Online Shop" class="w-full bg-gray-800 border border-gray-600 rounded-lg p-3 text-sm font-medium text-white focus:border-brand-neon focus:ring-1 focus:ring-brand-neon outline-none h-24 leading-relaxed placeholder-gray-500"></textarea>
                                </div>
                                
                                <!-- Audience Container (Hidden for M-Pesa) -->
                                <div id="audienceContainer">
                                    <label id="label2" class="block text-xs font-bold text-brand-neon uppercase mb-2 tracking-wide">Target Audience / Details</label>
                                    <textarea id="audienceInput" placeholder="e.g. Corporate men in Nairobi / Client owes 50k" class="w-full bg-gray-800 border border-gray-600 rounded-lg p-3 text-sm font-medium text-white focus:border-brand-neon focus:ring-1 focus:ring-brand-neon outline-none h-24 leading-relaxed placeholder-gray-500"></textarea>
                                </div>

                                <!-- Controls (Goals/Tone) - Hidden for M-Pesa Parser -->
                                <div id="controlsContainer">
                                    <div class="mb-6">
                                        <label class="block text-xs font-bold text-gray-300 uppercase mb-2 tracking-wide">Goal / Intent</label>
                                        <div class="grid grid-cols-3 gap-3">
                                            <button class="goal-btn p-3 border-2 border-brand-neon bg-brand-neon/20 text-brand-neon text-xs font-bold rounded shadow-neon transition-all" onclick="selectGoal(this)">Direct</button>
                                            <button class="goal-btn p-3 border border-gray-600 bg-gray-800 text-gray-300 text-xs font-bold rounded hover:bg-gray-700 transition-all" onclick="selectGoal(this)">Value</button>
                                            <button class="goal-btn p-3 border border-gray-600 bg-gray-800 text-gray-300 text-xs font-bold rounded hover:bg-gray-700 transition-all" onclick="selectGoal(this)">Urgent</button>
                                        </div>
                                    </div>
                                    <div>
                                        <label class="block text-xs font-bold text-gray-300 uppercase mb-2 tracking-wide">Tone Intensity</label>
                                        <input type="range" id="toneInput" min="0" max="100" value="70" class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-brand-neon">
                                        <div class="flex justify-between text-[10px] font-bold text-gray-400 mt-2"><span>Soft</span><span>Balanced</span><span class="text-brand-neon">Aggressive</span></div>
                                    </div>
                                </div>

                                <button id="generateBtn" onclick="generateCampaign()" class="w-full py-4 mt-2 bg-brand-neon text-brand-dark font-extrabold text-sm rounded-lg hover:bg-brand-neonhover shadow-lg shadow-brand-neon/30 transition-all flex justify-center items-center group">
                                    <i class="fa-solid fa-bolt mr-2 group-hover:animate-pulse"></i> GENERATE OUTPUT
                                </button>
                            </div>

                            <!-- Output Column -->
                            <div class="bg-black border border-gray-700 rounded-lg p-5 font-mono text-sm text-gray-200 relative app-scroll overflow-y-auto shadow-inner">
                                <div class="absolute top-3 right-3 flex space-x-1.5 opacity-70"><div class="w-2.5 h-2.5 rounded-full bg-red-500"></div><div class="w-2.5 h-2.5 rounded-full bg-yellow-500"></div><div class="w-2.5 h-2.5 rounded-full bg-green-500"></div></div>
                                
                                <div class="mb-6 pb-6 border-b border-gray-800">
                                    <span class="text-brand-purple font-bold block mb-2 text-xs uppercase tracking-wider" id="labelA">// Option A</span>
                                    <div id="outputA" class="leading-relaxed text-gray-100 min-h-[80px]"><span class="text-gray-500 italic">... Waiting for input ...</span></div>
                                </div>
                                <div>
                                    <span class="text-brand-purple font-bold block mb-2 text-xs uppercase tracking-wider" id="labelB">// Option B</span>
                                    <div id="outputB" class="leading-relaxed text-gray-100 min-h-[80px]"><span class="text-gray-500 italic">... Waiting for input ...</span></div>
                                </div>
                            </div>
                        </div>

                        <!-- 2. WHATSAPP AGENT DASHBOARD -->
                        <div id="agentDashboard" class="flex-1 p-6 grid lg:grid-cols-2 gap-8 overflow-hidden hidden-view">
                            <div class="space-y-6 app-scroll overflow-y-auto pr-2">
                                <div class="p-4 bg-green-500/10 border border-green-500/20 rounded-lg">
                                    <h3 class="text-green-400 font-bold mb-1"><i class="fa-solid fa-robot mr-2"></i>Agent Configuration</h3>
                                    <p class="text-xs text-gray-400">Train your bot to answer like you.</p>
                                </div>
                                <div><label class="block text-xs font-bold text-gray-300 uppercase mb-2">Business Name</label><input type="text" value="SmartBiz Electronics" class="w-full bg-gray-800 border border-gray-600 rounded-lg p-3 text-sm text-white focus:border-green-500 outline-none"></div>
                                <div><label class="block text-xs font-bold text-gray-300 uppercase mb-2">Welcome Message</label><textarea class="w-full bg-gray-800 border border-gray-600 rounded-lg p-3 text-sm text-white focus:border-green-500 h-20">Habari! ðŸ‘‹ Welcome to SmartBiz. How can I help you?</textarea></div>
                                <div>
                                    <label class="block text-xs font-bold text-gray-300 uppercase mb-2">Knowledge Base (PDF/Text)</label>
                                    <div class="border-2 border-dashed border-gray-600 rounded-lg p-6 text-center hover:border-green-500 transition cursor-pointer bg-gray-800/50 group" onclick="document.getElementById('fileUpload').click()"><i class="fa-solid fa-cloud-arrow-up text-3xl text-gray-500 mb-2 group-hover:text-green-400 transition"></i><p class="text-xs text-gray-400">Drag & Drop Price List or FAQ</p><p class="text-[10px] text-gray-500 mt-1">.pdf, .txt (Max 5MB)</p><input type="file" id="fileUpload" class="hidden" onchange="alert('File uploaded to Knowledge Base (Simulation)')"></div>
                                </div>
                                <button id="connectWaBtn" onclick="connectWhatsApp()" class="w-full py-3 bg-green-600 hover:bg-green-500 text-white font-bold rounded-lg transition-all shadow-lg flex justify-center items-center"><i class="fa-brands fa-whatsapp mr-2"></i> Connect WhatsApp Number</button>
                            </div>
                            <div class="flex justify-center items-center bg-gray-800/30 rounded-xl border border-gray-700 p-4">
                                <div class="relative border-gray-900 bg-gray-900 border-[8px] rounded-[2rem] h-[450px] w-[250px] shadow-2xl flex flex-col overflow-hidden">
                                    <div class="bg-[#202c33] p-3 text-white text-xs font-bold flex items-center border-b border-gray-700"><div class="w-6 h-6 bg-green-500 rounded-full mr-2"></div> Bot Preview</div>
                                    <div class="flex-1 bg-[#0b141a] p-3 space-y-2"><div class="bg-[#202c33] text-white text-[10px] p-2 rounded-lg max-w-[80%]">Do you have stock?</div><div class="bg-[#005c4b] text-white text-[10px] p-2 rounded-lg max-w-[80%] self-end ml-auto">Yes! We have full stock available.</div></div>
                                    <div id="qrLoader" class="absolute inset-0 bg-black/90 flex flex-col items-center justify-center text-center p-4 hidden-view z-10"><i class="fa-solid fa-spinner fa-spin-slow text-4xl text-green-500 mb-4"></i><p class="text-white text-xs mb-2">Generating QR Code...</p><p class="text-gray-400 text-[10px]">Please wait while we connect to WhatsApp servers.</p></div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- PRICING SECTION -->
    <section id="pricing" class="py-24 bg-gray-900 border-t border-gray-800">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-4xl font-extrabold text-white mb-12 text-center">Invest in <span class="text-brand-neon">Growth</span></h2>
            <div class="grid md:grid-cols-3 gap-8 max-w-5xl mx-auto">
                <div class="p-8 border border-gray-700 rounded-2xl bg-gray-900 shadow-xl flex flex-col"><h3 class="text-lg font-bold text-gray-300 uppercase tracking-wide">Starter</h3><p class="text-4xl font-extrabold text-white mt-4 mb-6">Free</p><ul class="space-y-4 text-sm text-gray-200 mb-8 font-medium flex-1"><li class="flex items-center"><i class="fa-solid fa-check text-green-500 mr-3"></i> 5 Generations / Day</li><li class="flex items-center"><i class="fa-solid fa-check text-green-500 mr-3"></i> Basic Ads & Socials</li></ul><button onclick="Clerk.openSignUp()" class="block w-full py-4 border-2 border-gray-500 rounded-lg text-center font-bold text-white hover:bg-gray-800 hover:border-white transition">Sign Up Free</button></div>
                <div class="p-8 border-2 border-brand-neon rounded-2xl bg-gray-900 relative transform md:-translate-y-6 shadow-neon z-10 flex flex-col"><div class="absolute top-0 right-0 bg-brand-neon text-brand-dark text-xs font-bold px-4 py-1.5 rounded-bl-lg rounded-tr-lg tracking-wider">MOST POPULAR</div><h3 class="text-lg font-bold text-brand-neon uppercase tracking-wide">Growth</h3><p class="text-4xl font-extrabold text-white mt-4 mb-6">KES 2,500<span class="text-sm font-semibold text-gray-400">/mo</span></p><ul class="space-y-4 text-sm text-gray-100 mb-8 font-medium flex-1"><li class="flex items-center"><i class="fa-solid fa-check text-brand-neon mr-3"></i> <strong>Unlimited Generations</strong></li><li class="flex items-center"><i class="fa-solid fa-check text-brand-neon mr-3"></i> Cold Call Scripts</li><li class="flex items-center"><i class="fa-solid fa-check text-brand-neon mr-3"></i> Debt Collection Tools</li><li class="flex items-center"><i class="fa-solid fa-check text-brand-neon mr-3"></i> Save History</li></ul><a href="#" class="block w-full py-4 bg-brand-neon rounded-lg text-center font-extrabold text-brand-dark hover:bg-brand-neonhover transition shadow-lg">Start 7-Day Trial</a><p class="text-center text-xs text-gray-500 mt-3">M-Pesa Accepted</p></div>
                <div class="p-8 border-2 border-green-500 rounded-2xl bg-gray-900 shadow-xl flex flex-col"><h3 class="text-lg font-bold text-green-400 uppercase tracking-wide">Business</h3><p class="text-4xl font-extrabold text-white mt-4 mb-6">KES 7,500<span class="text-sm font-semibold text-gray-400">/mo</span></p><ul class="space-y-4 text-sm text-gray-200 mb-8 font-medium flex-1"><li class="flex items-center"><i class="fa-solid fa-check text-green-500 mr-3"></i> Everything in Growth</li><li class="flex items-center"><i class="fa-solid fa-robot text-green-500 mr-3"></i> <strong>AI WhatsApp Agent</strong></li><li class="flex items-center"><i class="fa-solid fa-check text-green-500 mr-3"></i> Auto-Reply to Customers</li></ul><a href="mailto:sales@smartbizsystems.co.ke" class="block w-full py-4 border-2 border-green-600 text-green-400 rounded-lg text-center font-bold hover:bg-green-900/20 hover:border-green-400 transition">Contact Sales</a></div>
            </div>
        </div>
    </section>

    <footer class="bg-black border-t border-gray-800 pt-12 pb-10">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <span class="text-2xl font-bold tracking-tight text-white block mb-6">SmartBiz<span class="text-brand-neon">Tool</span></span>
            <p class="text-gray-600 text-sm font-medium">&copy; 2023 SmartBizSystems. Powered by NdovuCloud AI Infrastructure.</p>
        </div>
    </footer>

    <!-- ============================================ -->
    <!-- SCRIPTS                                     -->
    <!-- ============================================ -->

    <!-- 1. CLERK SDK (AUTH) -->
    <!-- REPLACE WITH YOUR LIVE KEY -->
    <script
      async
      crossorigin="anonymous"
      data-clerk-publishable-key="pk_test_YOUR_CLERK_KEY"
      src="https://cdn.jsdelivr.net/npm/@clerk/clerk-js@latest/dist/clerk.browser.js"
      type="text/javascript"
    ></script>

    <!-- 2. APP LOGIC -->
    <script>
        // CONFIG
        const DEV_MODE = true; // Set to TRUE to bypass login/DNS
        const PAYSTACK_PUBLIC_KEY = 'pk_test_54930101b0f5b9d21226a27616616e033d59648c'; 

        let selectedGoal = "Direct";
        let clerkInstance = null;
        let currentUser = null;

        // 1. FORCE LOADER HIDE
        function hideLoader() {
            const loader = document.getElementById('global-loader');
            if(loader) {
                loader.style.opacity = '0';
                setTimeout(() => loader.remove(), 500);
            }
        }

        // 2. INITIALIZATION
        window.addEventListener("DOMContentLoaded", async function () {
            
            // IF DEV MODE: Bypass everything and load UI
            if (DEV_MODE) {
                console.log("âš ï¸ DEVELOPER MODE ACTIVE: Bypassing Auth & DNS Checks");
                currentUser = {
                    firstName: "Developer",
                    imageUrl: "https://ui-avatars.com/api/?name=Dev+Admin&background=2DD4BF&color=fff",
                    publicMetadata: { isPro: true }
                };
                updateUIForUser(currentUser);
                hideLoader();
                return;
            }

            // REAL MODE
            try {
                // Safety Timer: If Clerk takes > 3s, force open
                const safetyTimer = setTimeout(() => {
                    console.log("Clerk slow. Forcing guest mode.");
                    updateUIForGuest();
                    hideLoader();
                }, 3000);

                await Clerk.load();
                clearTimeout(safetyTimer);
                clerkInstance = Clerk;

                if (Clerk.user) {
                    currentUser = Clerk.user;
                    updateUIForUser(Clerk.user);
                } else {
                    updateUIForGuest();
                }
            } catch (error) {
                console.error("Clerk Error:", error);
                updateUIForGuest(); // Fallback
            } finally {
                hideLoader();
            }
        });

        // 3. UI HELPERS
        function updateUIForUser(user) {
            const isPro = user.publicMetadata.isPro === true;
            const planName = isPro ? '<span class="text-brand-neon">PRO UNLOCKED</span>' : 'Free Tier';
            const profileArea = document.getElementById('userProfileArea');
            if(profileArea) {
                profileArea.innerHTML = `<div class="flex items-center"><img src="${user.imageUrl}" class="w-8 h-8 rounded-full border border-brand-neon"><div class="ml-3"><p class="text-xs font-bold text-white">${user.firstName}</p><p class="text-[10px] font-medium text-gray-400">${planName}</p></div></div>`;
            }
            const authArea = document.getElementById('authActionArea');
            if(authArea) {
                authArea.innerHTML = `<button onclick="Clerk.signOut()" class="hidden md:flex items-center space-x-2 text-xs font-bold text-gray-300 hover:text-red-400 transition"><i class="fa-solid fa-right-from-bracket"></i><span>Sign Out</span></button>`;
            }
        }

        function updateUIForGuest() {
             const profileArea = document.getElementById('userProfileArea');
             if(profileArea) {
                profileArea.innerHTML = `<div class="flex items-center"><div class="w-8 h-8 rounded-full bg-gradient-to-tr from-brand-neon to-blue-600 border border-white/20"></div><div class="ml-3"><p class="text-xs font-bold text-white">Guest</p><p class="text-[10px] font-medium text-gray-400">Free Mode</p></div></div>`;
             }
             const authArea = document.getElementById('authActionArea');
             if(authArea) {
                authArea.innerHTML = `<button onclick="Clerk.openSignIn()" class="hidden md:flex items-center space-x-2 text-xs font-bold text-gray-300 hover:text-brand-purple transition group"><i class="fa-solid fa-lock group-hover:animate-pulse"></i><span>Login to Save History</span></button>`;
             }
        }

        function toggleMobileMenu() {
            const menu = document.getElementById('mobile-menu');
            const icon = document.getElementById('menu-icon');
            menu.classList.toggle('hidden');
            if (menu.classList.contains('hidden')) { icon.classList.remove('fa-xmark'); icon.classList.add('fa-bars'); } 
            else { icon.classList.remove('fa-bars'); icon.classList.add('fa-xmark'); }
        }

        // 4. SWITCH TOOLS LOGIC
        function switchMode(btn, modeName) {
            document.getElementById('currentMode').innerText = modeName;
            
            const standardView = document.getElementById('standardWorkspace');
            const agentView = document.getElementById('agentDashboard');

            // View Toggle
            if (modeName === 'WhatsApp Agent') {
                standardView.classList.add('hidden-view');
                agentView.classList.remove('hidden-view');
                if (window.innerWidth < 768) setTimeout(() => agentView.scrollIntoView({ behavior: 'smooth' }), 100);
            } else {
                standardView.classList.remove('hidden-view');
                agentView.classList.add('hidden-view');
                if (window.innerWidth < 768) setTimeout(() => standardView.scrollIntoView({ behavior: 'smooth' }), 100);

                // Update Input Labels
                const l1 = document.getElementById('label1'); const l2 = document.getElementById('label2');
                const i1 = document.getElementById('productInput'); const i2 = document.getElementById('audienceInput');
                const audienceContainer = document.getElementById('audienceContainer');
                const controlsContainer = document.getElementById('controlsContainer');

                // Reset Defaults
                if(audienceContainer) audienceContainer.classList.remove('hidden-view');
                if(controlsContainer) controlsContainer.classList.remove('hidden-view');
                if(i2) i2.value = "";

                if (modeName === 'Cold Call Script') {
                    l1.innerText = "Target Website OR LinkedIn URL"; i1.placeholder = "e.g. www.naivas.co.ke";
                    l2.innerText = "Value Prop"; i2.placeholder = "e.g. POS Systems";
                } else if (modeName === 'Debt Collection') {
                    l1.innerText = "Client Name"; i1.placeholder = "e.g. John Kamau";
                    l2.innerText = "Details"; i2.placeholder = "e.g. Owes KES 50k";
                } else if (modeName === 'M-Pesa Parser') {
                    l1.innerText = "Paste SMS Messages"; i1.placeholder = "QL042... Confirmed. Ksh2,500.00 sent to... \nQL043... Confirmed. Ksh1,000.00 received from...";
                    if(audienceContainer) audienceContainer.classList.add('hidden-view'); 
                    if(controlsContainer) controlsContainer.classList.add('hidden-view');
                    document.getElementById('outputA').innerHTML = ""; // Clear Previous output
                    document.getElementById('outputB').innerHTML = "";
                } else {
                    l1.innerText = "Product / Topic"; i1.placeholder = "e.g. Selling Plots";
                    l2.innerText = "Target Audience"; i2.placeholder = "e.g. Investors";
                }
            }

            document.querySelectorAll('.sidebar-btn').forEach(b => {
                b.className = b.innerText.includes("Configure Bot") ? 
                    'sidebar-btn w-full flex items-center px-3 py-2 text-sm font-bold text-green-400 bg-green-400/10 rounded-lg border border-green-400/30 shadow-sm transition-all hover:bg-green-400/20' : 
                    'sidebar-btn w-full flex items-center px-3 py-2 text-sm font-medium text-gray-300 hover:text-white hover:bg-gray-800 rounded-lg transition-all';
            });
            
            if (!modeName.includes("Agent")) {
                btn.className = 'sidebar-btn w-full flex items-center px-3 py-2 text-sm font-bold text-brand-neon bg-gray-800 rounded-lg border border-brand-neon/40 shadow-sm transition-all';
            }
        }

        function selectGoal(btn) {
            document.querySelectorAll('.goal-btn').forEach(b => {
                b.classList.remove('border-2', 'border-brand-neon', 'bg-brand-neon/20', 'text-brand-neon', 'shadow-neon');
                b.classList.add('border', 'border-gray-600', 'bg-gray-800', 'text-gray-300');
            });
            btn.classList.remove('border', 'border-gray-600', 'bg-gray-800', 'text-gray-300');
            btn.classList.add('border-2', 'border-brand-neon', 'bg-brand-neon/20', 'text-brand-neon', 'shadow-neon');
            selectedGoal = btn.innerText;
        }

        // 5. GENERATION LOGIC
        function formatAIResponse(data) {
            if (typeof data === 'string') return data.replace(/\n/g, "<br>");
            if (typeof data === 'object' && data !== null) {
                return Object.values(data).map(val => String(val).replace(/\n/g, "<br>")).join('<br><br>');
            }
            return "No content generated.";
        }

        async function generateCampaign() {
            // AUTH CHECK
            if (!DEV_MODE && !Clerk.user) { Clerk.openSignIn(); return; }
            
            // PAYWALL CHECK
            const isPro = currentUser?.publicMetadata?.isPro === true;
            if (!DEV_MODE && !isPro) { payWithPaystack(currentUser); return; }

            const i1 = document.getElementById('productInput').value;
            const i2 = document.getElementById('audienceInput') ? document.getElementById('audienceInput').value : "";
            const btn = document.getElementById('generateBtn');
            const originalText = btn.innerHTML;
            const mode = document.getElementById('currentMode').innerText;
            const toneInput = document.getElementById('toneInput');
            const toneVal = toneInput ? toneInput.value : 50;
            let toneText = toneVal > 60 ? "Aggressive" : (toneVal < 40 ? "Soft" : "Balanced");

            if (!i1) { alert("Please fill in the input field."); return; }

            btn.innerHTML = '<i class="fa-solid fa-circle-notch fa-spin mr-2"></i> THINKING...';
            btn.disabled = true;
            btn.classList.add('opacity-75', 'cursor-not-allowed');

            // --- LOCAL TOOLS (NO API) ---
            if (mode === "M-Pesa Parser") {
                // Regex: Code, Amount, Date, Time, Party
                // Looks for: "Confirmed. Ksh 1,500.00" OR "Ksh1500"
                const regex = /([A-Z0-9]{10}).*?Confirmed.*?Ksh\s*([\d,]+\.?\d*).*?(?:sent to|paid to|received from|bought).*?([A-Z\s]+(?:\d+)?).*?on\s+(\d{1,2}\/\d{1,2}\/\d{2,4})\s+at\s+(\d{1,2}:\d{2}\s?[AP]M)/gi;
                
                let match, tableRows = "", totalAmount = 0, count = 0;
                // Note: Regex is tricky with variations, using a robust approximation
                // Backup simple regex if the complex one fails for manual paste
                
                const lines = i1.split('\n');
                lines.forEach(line => {
                     // Simple extraction for each line
                     const codeMatch = line.match(/([A-Z0-9]{10})/);
                     const amountMatch = line.match(/Ksh\s?([\d,]+\.?\d*)/i);
                     const dateMatch = line.match(/on\s+(\d{1,2}\/\d{1,2}\/\d{2,4})/);
                     
                     if (codeMatch && amountMatch) {
                         const code = codeMatch[1];
                         const amount = parseFloat(amountMatch[1].replace(/,/g, ''));
                         const date = dateMatch ? dateMatch[1] : "N/A";
                         
                         totalAmount += amount;
                         count++;
                         tableRows += `<tr class="border-b border-gray-700"><td class="p-2 text-brand-neon font-mono text-xs">${code}</td><td class="p-2 text-white text-xs">${date}</td><td class="p-2 text-gray-300 text-xs">-</td><td class="p-2 text-green-400 font-bold text-xs text-right">${amount.toLocaleString()}</td></tr>`;
                     }
                });

                setTimeout(() => {
                    if (count === 0) {
                        document.getElementById('outputA').innerHTML = "No M-Pesa messages detected.";
                        document.getElementById('outputB').innerHTML = "Format: 'QL042... Confirmed...'";
                    } else {
                        document.getElementById('outputA').innerHTML = `<div class="overflow-x-auto"><table class="w-full text-left border-collapse"><thead><tr class="text-xs text-gray-500 uppercase bg-gray-800"><th class="p-2">Code</th><th class="p-2">Date</th><th class="p-2">Party</th><th class="p-2 text-right">Amount</th></tr></thead><tbody>${tableRows}</tbody><tfoot><tr class="bg-gray-800 font-bold"><td colspan="3" class="p-2 text-right text-white">TOTAL:</td><td class="p-2 text-right text-green-400">KES ${totalAmount.toLocaleString()}</td></tr></tfoot></table><p class="text-xs text-gray-500 mt-2">${count} transactions found.</p></div>`;
                        document.getElementById('outputB').innerHTML = `<div class="space-y-4"><h3 class="text-brand-orange font-bold text-sm"><i class="fa-solid fa-file-csv mr-2"></i>Export Ready</h3></div>`;
                    }
                    resetBtn();
                }, 500);
                return;
            }

            // --- API CALL ---
            try {
                const response = await fetch('/api/generate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ product: i1, audience: i2, mode: mode, goal: selectedGoal, tone: toneText })
                });

                if(!response.ok) throw new Error("API Failed");
                const data = await response.json();
                
                document.getElementById('outputA').innerHTML = formatAIResponse(data.variationA);
                document.getElementById('outputB').innerHTML = formatAIResponse(data.variationB);

            } catch (error) {
                console.log("API Failed/Localhost - Using Simulation");
                
                setTimeout(() => {
                    let mockA = `(Simulation: ${mode})<br><br>ðŸ”¥ <strong>${i1}</strong> is trending!<br>Generated for ${currentUser.firstName}.`;
                    let mockB = `(Simulation B)<br><br>Stop scrolling. <strong>${i1}</strong> is the solution.`;
                    
                    if(mode === "Cold Call Script") mockA = `<p><strong>You:</strong> "Hi, I was browsing ${i1}..."</p>`;
                    
                    document.getElementById('outputA').innerHTML = mockA;
                    document.getElementById('outputB').innerHTML = mockB;
                }, 1000);
            } finally {
                resetBtn();
            }

            function resetBtn() {
                btn.innerHTML = originalText;
                btn.disabled = false;
                btn.classList.remove('opacity-75', 'cursor-not-allowed');
            }
        }

        // 6. EXTRAS
        function connectWhatsApp() {
            const btn = document.getElementById('connectWaBtn');
            const loader = document.getElementById('qrLoader');
            btn.innerHTML = '<i class="fa-solid fa-spinner fa-spin mr-2"></i> Generating QR...';
            setTimeout(() => {
                loader.classList.remove('hidden-view');
                btn.innerHTML = '<i class="fa-solid fa-check mr-2"></i> QR Ready (Scan Now)';
            }, 2000);
        }

        function exportToTxt() {
            const i1 = document.getElementById('productInput').value || "Untitled";
            const contentA = document.getElementById('outputA').innerText;
            const contentB = document.getElementById('outputB').innerText;
            if (contentA.includes("Waiting")) { alert("Generate content first!"); return; }
            const blob = new Blob([`SMARTBIZ COMMANDER\nTopic: ${i1}\n\n${contentA}\n\n${contentB}`], { type: "text/plain" });
            const a = document.createElement("a"); a.href = URL.createObjectURL(blob); a.download = `${i1.replace(/\s+/g, '_')}_Content.txt`;
            document.body.appendChild(a); a.click(); document.body.removeChild(a);
        }
        
        function payWithPaystack(user) {
             let handler = PaystackPop.setup({
                key: PAYSTACK_PUBLIC_KEY, 
                email: user.primaryEmailAddress.emailAddress,
                amount: 2500 * 100, 
                currency: 'KES',
                ref: ''+Math.floor((Math.random() * 1000000000) + 1),
                callback: function(response) {
                    alert('Payment successful!');
                    // Call API to upgrade user
                },
                onClose: function() { alert('Transaction cancelled.'); }
            });
            handler.openIframe();
        }
    </script>

</body>
</html>